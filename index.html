<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Pixel Dash</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
    html, body {
        margin: 0;
        padding: 0;
        font-family: 'Segoe UI', sans-serif;
        background: linear-gradient(135deg, #1d1d1d, #2e2e2e);
        color: white;
        overflow: hidden;
    }

    /* Center utility */
    .center {
        display: flex;
        justify-content: center;
        align-items: center;
    }

    /* Landing page styles */
    #landing {
        height: 100vh;
        flex-direction: column;
        text-align: center;
    }
    .logo {
        font-size: 64px;
        font-weight: bold;
        color: #00d4ff;
        text-shadow: 0 0 10px #00d4ff, 0 0 20px #00d4ff;
        margin-bottom: 20px;
    }
    .desc {
        font-size: 18px;
        max-width: 600px;
        margin: 0 auto 30px auto;
        color: #ccc;
    }
    .play-btn {
        background: #00d4ff;
        border: none;
        padding: 15px 30px;
        font-size: 20px;
        border-radius: 8px;
        cursor: pointer;
        color: #000;
        font-weight: bold;
        transition: background 0.3s;
    }
    .play-btn:hover {
        background: #00aacc;
    }

    /* Device selection styles */
    #device-select {
        height: 100vh;
        flex-direction: column;
        display: none;
        text-align: center;
    }
    .device-btn {
        background: #444;
        border: none;
        padding: 15px 30px;
        font-size: 20px;
        border-radius: 8px;
        cursor: pointer;
        color: white;
        margin: 10px;
        transition: background 0.3s;
    }
    .device-btn:hover {
        background: #666;
    }

    /* Game canvas */
    #game-container {
        display: none;
        background: black;
        height: 100vh;
        width: 100vw;
    }
    canvas {
        display: block;
        margin: auto;
        background: #4cafef;
        box-shadow: 0 0 20px rgba(0,0,0,0.5);
    }
</style>
</head>
<body>

<!-- Landing Page -->
<div id="landing" class="center">
    <div class="logo">ðŸŽ® Pixel Dash</div>
    <div class="desc">
        A fast-paced one-tap / swipe reaction game where you control a cube racing through a world of spikes and gaps.  
        Jump, dodge, and survive as the speed increases.  
        Can you master the double-speed mode and beat your high score?
    </div>
    <button class="play-btn" onclick="showDeviceSelect()">Play Now</button>
</div>

<!-- Device Selection -->
<div id="device-select" class="center">
    <h2>Select your device</h2>
    <button class="device-btn" onclick="startGame('pc')">ðŸ’» PC</button>
    <button class="device-btn" onclick="startGame('mobile')">ðŸ“± Phone</button>
</div>

<!-- Game Container -->
<div id="game-container" class="center">
    <canvas id="game"></canvas>
</div>

<script>
// UI Navigation
function showDeviceSelect() {
    document.getElementById("landing").style.display = "none";
    document.getElementById("device-select").style.display = "flex";
}

function startGame(device) {
    document.getElementById("device-select").style.display = "none";
    document.getElementById("game-container").style.display = "flex";
    initGame(device);
}

// Game Variables
let canvas, ctx, isMobile, width, height, cube, gravity, jumpForce, speed, obstacles, groundHeight, score, level, bgColor, doubleSpeedTimer, gameOver;

// Initialize Game
function initGame(device) {
    canvas = document.getElementById("game");
    ctx = canvas.getContext("2d");

    isMobile = device === "mobile";
    width = isMobile ? window.innerWidth : 800;
    height = isMobile ? window.innerHeight : 400;
    canvas.width = width;
    canvas.height = height;

    cube = { x: 100, y: height - 60, size: 40, dy: 0, jumping: false };
    gravity = 0.6;
    jumpForce = -12;
    speed = 6;
    obstacles = [];
    groundHeight = 40;
    score = 0;
    level = 1;
    bgColor = "#4cafef";
    doubleSpeedTimer = 0;
    gameOver = false;

    if (isMobile) {
        let touchStartX = 0, touchStartY = 0;
        canvas.addEventListener("touchstart", e => {
            touchStartX = e.touches[0].clientX;
            touchStartY = e.touches[0].clientY;
        });
        canvas.addEventListener("touchend", e => {
            let dx = e.changedTouches[0].clientX - touchStartX;
            let dy = e.changedTouches[0].clientY - touchStartY;
            if (Math.abs(dx) < 50 && Math.abs(dy) < 50) {
                jump();
            }
        });
    } else {
        document.addEventListener("keydown", e => {
            if (e.code === "Space" || e.code === "ArrowUp") jump();
            if (gameOver && e.code === "Enter") resetGame();
        });
    }

    loop();
}

// Game Functions
function spawnObstacle() {
    let type = Math.random() < 0.5 ? "gap" : "spike";
    let widthOrGap = type === "gap" ? 80 + Math.random() * 40 : 40;
    obstacles.push({
        x: canvas.width,
        y: height - groundHeight - (type === "spike" ? 40 : 0),
        width: widthOrGap,
        height: type === "spike" ? 40 : 0,
        type: type
    });
}

function jump() {
    if (!cube.jumping) {
        cube.dy = jumpForce;
        cube.jumping = true;
    }
}

function update() {
    if (gameOver) return;
    let currentSpeed = doubleSpeedTimer > 0 ? speed * 2 : speed;
    if (doubleSpeedTimer > 0) doubleSpeedTimer--;

    cube.y += cube.dy;
    cube.dy += gravity;
    if (cube.y >= height - cube.size - groundHeight) {
        cube.y = height - cube.size - groundHeight;
        cube.jumping = false;
    }

    obstacles.forEach(o => o.x -= currentSpeed);
    obstacles = obstacles.filter(o => o.x + o.width > 0);

    if (Math.random() < 0.02) spawnObstacle();

    for (let o of obstacles) {
        if (o.type === "spike") {
            if (cube.x < o.x + o.width && cube.x + cube.size > o.x && cube.y + cube.size > o.y) {
                gameOver = true;
            }
        } else if (o.type === "gap") {
            if (cube.x + cube.size > o.x && cube.x < o.x + o.width && cube.y + cube.size >= height - groundHeight) {
                gameOver = true;
            }
        }
    }

    score++;
    if (score % 500 === 0) {
        level++;
        bgColor = `hsl(${Math.random() * 360}, 60%, 60%)`;
        if (Math.random() < 0.3) doubleSpeedTimer = 200;
    }
}

function draw() {
    ctx.fillStyle = bgColor;
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    ctx.fillStyle = "#222";
    ctx.fillRect(0, height - groundHeight, canvas.width, groundHeight);
    ctx.fillStyle = "#fff";
    ctx.fillRect(cube.x, cube.y, cube.size, cube.size);
    ctx.fillStyle = "#e53935";
    obstacles.forEach(o => {
        if (o.type === "spike") {
            ctx.beginPath();
            ctx.moveTo(o.x, o.y + o.height);
            ctx.lineTo(o.x + o.width / 2, o.y);
            ctx.lineTo(o.x + o.width, o.y + o.height);
            ctx.closePath();
            ctx.fill();
        }
    });

    ctx.fillStyle = "#fff";
    ctx.font = "20px Arial";
    ctx.fillText(`Score: ${score}`, 10, 25);
    ctx.fillText(`Level: ${level}`, 10, 50);

    if (gameOver) {
        ctx.fillStyle = "#fff";
        ctx.font = "40px Arial";
        ctx.fillText("Game Over", canvas.width / 2 - 100, canvas.height / 2);
        ctx.font = "20px Arial";
        ctx.fillText("Press Enter to Restart", canvas.width / 2 - 100, canvas.height / 2 + 40);
    }
}

function loop() {
    update();
    draw();
    requestAnimationFrame(loop);
}

function resetGame() {
    cube.y = height - 60;
    cube.dy = 0;
    cube.jumping = false;
    score = 0;
    level = 1;
    speed = 6;
    obstacles = [];
    bgColor = "#4cafef";
    gameOver = false;
}
</script>

</body>
</html>
