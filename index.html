<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Minesweeper // C0d3r_M0d3</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
    @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');
    :root {
        --bg: #0a0f0a;
        --primary: #00ff9f;
        --secondary: #00ffaa;
        --danger: #ff4d4d;
        --cell-bg: #0f1912;
        --cell-hover: #14261b;
    }
    body {
        margin: 0;
        font-family: 'Share Tech Mono', monospace;
        background: var(--bg);
        color: var(--primary);
        display: flex;
        flex-direction: column;
        align-items: center;
        height: 100vh;
        overflow: hidden;
    }
    header {
        text-align: center;
        margin-top: 10px;
    }
    h1 {
        font-size: 32px;
        color: var(--secondary);
        text-shadow: 0 0 5px var(--secondary), 0 0 20px var(--secondary);
        letter-spacing: 2px;
    }
    #controls {
        margin: 10px;
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        justify-content: center;
    }
    button {
        padding: 6px 12px;
        font-size: 14px;
        background: transparent;
        border: 1px solid var(--primary);
        color: var(--primary);
        cursor: pointer;
        transition: 0.2s;
        text-shadow: 0 0 5px var(--primary);
    }
    button:hover {
        background: var(--cell-hover);
        box-shadow: 0 0 10px var(--primary);
    }
    #game-container {
        display: grid;
        gap: 1px;
        background: var(--primary);
        padding: 5px;
        border-radius: 4px;
        box-shadow: 0 0 15px var(--primary);
        margin-top: 5px;
        position: relative;
        overflow: hidden;
    }
    .scanlines {
        pointer-events: none;
        position: absolute;
        top: 0;
        left: 0;
        height: 100%;
        width: 100%;
        background: repeating-linear-gradient(
            to bottom,
            rgba(0, 255, 159, 0.03),
            rgba(0, 255, 159, 0.03) 2px,
            transparent 2px,
            transparent 4px
        );
        animation: scroll 5s linear infinite;
    }
    @keyframes scroll {
        0% { transform: translateY(0); }
        100% { transform: translateY(4px); }
    }
    .cell {
        width: 28px;
        height: 28px;
        background: var(--cell-bg);
        display: flex;
        justify-content: center;
        align-items: center;
        font-weight: bold;
        cursor: pointer;
        user-select: none;
        color: var(--primary);
        text-shadow: 0 0 5px var(--primary);
    }
    .cell:hover {
        background: var(--cell-hover);
    }
    .cell.revealed {
        background: #001c11;
    }
    .cell.flagged {
        color: #ffcc00;
        text-shadow: 0 0 5px #ffcc00;
    }
    .cell.mine {
        background: var(--danger);
        color: black;
        text-shadow: none;
    }
    #status {
        margin-top: 10px;
        font-size: 14px;
        text-shadow: 0 0 5px var(--primary);
    }
</style>
</head>
<body>

<header>
    <h1>> MINESWEEPER_C0D3R_M0D3</h1>
</header>

<div id="controls">
    <button onclick="startGame(9, 9, 10)">[BEGINNER]</button>
    <button onclick="startGame(16, 16, 40)">[INTERMEDIATE]</button>
    <button onclick="startGame(30, 16, 99)">[EXPERT]</button>
    <button onclick="customGame()">[CUSTOM]</button>
</div>

<div id="game-container">
    <div class="scanlines"></div>
</div>
<div id="status"></div>

<script>
let rows, cols, mines, board, revealedCount, gameOverFlag;

function startGame(c, r, m) {
    cols = c;
    rows = r;
    mines = m;
    revealedCount = 0;
    gameOverFlag = false;
    generateBoard();
    drawBoard();
    statusMsg("SYSTEM ONLINE: Minesweeper grid generated.");
}

function customGame() {
    let c = parseInt(prompt("Columns:", 10));
    let r = parseInt(prompt("Rows:", 10));
    let m = parseInt(prompt("Mines:", 10));
    if (!c || !r || !m) return;
    startGame(c, r, m);
}

function statusMsg(msg) {
    document.getElementById("status").textContent = "> " + msg;
}

function generateBoard() {
    board = Array.from({ length: rows }, () =>
        Array.from({ length: cols }, () => ({
            mine: false,
            revealed: false,
            flagged: false,
            adjacent: 0
        }))
    );

    let placed = 0;
    while (placed < mines) {
        let x = Math.floor(Math.random() * cols);
        let y = Math.floor(Math.random() * rows);
        if (!board[y][x].mine) {
            board[y][x].mine = true;
            placed++;
        }
    }

    for (let y = 0; y < rows; y++) {
        for (let x = 0; x < cols; x++) {
            if (!board[y][x].mine) {
                let count = 0;
                for (let ny = -1; ny <= 1; ny++) {
                    for (let nx = -1; nx <= 1; nx++) {
                        if (ny === 0 && nx === 0) continue;
                        let yy = y + ny, xx = x + nx;
                        if (yy >= 0 && yy < rows && xx >= 0 && xx < cols && board[yy][xx].mine) {
                            count++;
                        }
                    }
                }
                board[y][x].adjacent = count;
            }
        }
    }
}

function drawBoard() {
    const container = document.getElementById("game-container");
    container.innerHTML = '<div class="scanlines"></div>';
    container.style.gridTemplateColumns = `repeat(${cols}, 28px)`;

    for (let y = 0; y < rows; y++) {
        for (let x = 0; x < cols; x++) {
            let cell = document.createElement("div");
            cell.classList.add("cell");
            cell.addEventListener("click", () => revealCell(x, y));
            cell.addEventListener("contextmenu", e => {
                e.preventDefault();
                toggleFlag(x, y);
            });
            container.appendChild(cell);
        }
    }
}

function revealCell(x, y) {
    if (gameOverFlag) return;
    let cell = board[y][x];
    if (cell.revealed || cell.flagged) return;
    cell.revealed = true;
    revealedCount++;

    let domCell = getCellElement(x, y);
    domCell.classList.add("revealed");
    if (cell.mine) {
        domCell.classList.add("mine");
        domCell.textContent = "X";
        statusMsg("!! BOOM !! SYSTEM FAILURE DETECTED.");
        endGame(false);
        return;
    }
    if (cell.adjacent > 0) {
        domCell.textContent = cell.adjacent;
    } else {
        for (let ny = -1; ny <= 1; ny++) {
            for (let nx = -1; nx <= 1; nx++) {
                if (ny === 0 && nx === 0) continue;
                let yy = y + ny, xx = x + nx;
                if (yy >= 0 && yy < rows && xx >= 0 && xx < cols) {
                    if (!board[yy][xx].revealed) revealCell(xx, yy);
                }
            }
        }
    }

    if (revealedCount === rows * cols - mines) {
        statusMsg("+++ SYSTEM CLEARED. MISSION SUCCESSFUL. +++");
        endGame(true);
    }
}

function toggleFlag(x, y) {
    if (gameOverFlag) return;
    let cell = board[y][x];
    if (cell.revealed) return;
    cell.flagged = !cell.flagged;
    let domCell = getCellElement(x, y);
    domCell.textContent = cell.flagged ? "F" : "";
    domCell.classList.toggle("flagged", cell.flagged);
}

function getCellElement(x, y) {
    return document.getElementById("game-container").children[1 + (y * cols + x)];
}

function endGame(win) {
    gameOverFlag = true;
    if (!win) {
        for (let y = 0; y < rows; y++) {
            for (let x = 0; x < cols; x++) {
                if (board[y][x].mine) {
                    let domCell = getCellElement(x, y);
                    domCell.classList.add("mine");
                    domCell.textContent = "X";
                }
            }
        }
    }
}
</script>
</body>
</html>
